webpackJsonp([24],{"692o":function(e,s){},exbN:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=t("Dd8w"),i=t.n(a),o=(t("dQyo"),t("NYxO")),r=t("teIl"),n=t("hRjh"),c=t.n(n),l=t("hsBw"),u=t.n(l),m=t("sDBu"),h=t.n(m),p=t("d2lw"),d=t.n(p),v=function(e,s){var t=parseInt(e/3600),a=parseInt(e%3600/60),i=parseInt(e%3600%60);return"h"==s?t<10?"0"+t:t:"m"==s?a<10?"0"+a:a:"s"==s?i<10?"0"+i:i:void 0};var b={data:function(){return{nativeShare:"",support:!1,clipboard:"",assembleRecordId:"",shareLink:"",shareOpen:!1,assembleStatus:1,assembleData:{continueTime:"-",courseTitle:"-",assemblePrice:"-",courseSurfacePlot:"",coursePrice:"-",id:"-",courseId:"-",peopleNum:"-"},assemblePeopleList:[],serviceTime:"",time:"",ms:"00",msTimer:"",timer:"",assembleContiTime:0,isWx:!1,countDownFlag:!1,wechatH5:!1,assembleBoughtDataCourseId:"",img1:c.a,img2:u.a,img3:h.a,img4:d.a}},components:{Header:r.a},computed:i()({},Object(o.c)(["hasOpenApp","assembleBoughtData"]),{hour:function(){return v(this.time,"h")},minute:function(){return v(this.time,"m")},second:function(){return v(this.time,"s")}}),beforeRouteLeave:function(e,s,t){"CourseOrder"==e.name&&0!=this.assembleData.channelAvaliDay?this.$dialog.confirm({message:"为了您更好的学习该课程内容，课程购买后，学习有效期至"+this.assembleData.channelAvaliDay+",请于有效期内学习完该课程",confirmButtonColor:"#D40015"}).then(function(){t()}).catch(function(){}):t()},created:function(){var e=this,s=void 0;"micromessenger"!=window.navigator.userAgent.toLowerCase().match(/MicroMessenger/i)&&"undefined"==typeof WeixinJSBridge||(s=!0),sessionStorage.getItem("wechatH5")&&(this.wechatH5=!0,sessionStorage.removeItem("wechatH5"));var t=this.$getCookie("uInfo"),a=t?JSON.parse(t).userid:"";this.browserSupport(),this.nativeShare=new NativeShare;var i=localStorage.getItem("assembleBoughtData")?JSON.parse(localStorage.getItem("assembleBoughtData")):null;i&&1==i.assembleSuccess?(localStorage.removeItem("assembleBoughtData"),this.assembleBoughtDataCourseId=i.courseId,this.assembleRecordId=i.assembleRecordId,this.assemblePeopleList=i.assemblePeopleList,this.shareLink=window.location.origin+"/?wxshare=true&type=assemble&assembleId="+this.$route.params.assembleId+"&assembleRecordId="+i.assembleRecordId+"&assembleUser="+a,this.assembleStatus=1==i.assembleType?2:3,this.getOpenAssembleCourseInfo(),this.assembleContiTime=i.assembleContiTime,this.serviceTime=i.serviceTime,this.countDownFlag=!0,this.countDown(),s&&this.wxshare(i.courseId),this.$nextTick(function(){e.assembleBoughtData({})})):this.assembleBoughtData&&1==this.assembleBoughtData.assembleSuccess?(this.assembleRecordId=this.assembleBoughtData.assembleRecordId,this.shareLink=window.location.origin+"/?wxshare=true&type=assemble&assembleId="+this.$route.params.assembleId+"&assembleRecordId="+this.assembleBoughtData.assembleRecordId+"&assembleUser="+a,this.assembleStatus=1==this.assembleBoughtData.assembleType?2:3,this.assemblePeopleList=this.assembleBoughtData.assemblePeopleList,this.getOpenAssembleCourseInfo(),this.assembleContiTime=this.assembleBoughtData.assembleContiTime,this.serviceTime=this.assembleBoughtData.serviceTime,this.countDownFlag=!0,this.countDown(),s&&this.wxshare(this.assembleBoughtData.courseId),this.$nextTick(function(){e.assembleBoughtData({})})):this.getOpenAssembleCourseInfo()},mounted:function(){},methods:i()({},Object(o.b)(["setAssembleBoughtData"]),{returnHome:function(){this.$router.push("/")},browserSupport:function(){var e=navigator.appVersion,s=e.split("UCBrowser/").length>1?1:0,t=e.split("MQQBrowser/").length>1?2:0,a=/micromessenger/i.test(e);this.support=!!(s||t||a)},onClickLeft:function(){this.wechatH5?this.$router.replace("/"):this.$router.go(-1)},getOpenAssembleCourseInfo:function(){var e=this;if(this.$route.params&&this.$route.params.assembleId){var s={assembleCourseId:this.$route.params.assembleId};this.$http.post(this.$server.getOpenAssembleCourseInfo,s).then(function(s){200==s.data.status&&(e.assembleData=s.data.content)})}},shareTo:function(e){var s=this;"micromessenger"==window.navigator.userAgent.toLowerCase().match(/MicroMessenger/i)||"undefined"!=typeof WeixinJSBridge?this.isWx=!0:(this.$toast.loading({mask:!1}),this.$http.post(this.$server.getCourseInfo,{courseId:this.assembleData.courseId}).then(function(t){if(200==t.data.status){var a=t.data.content.intro||"",i={title:(t.data.content.lectureTeacherList[0]?t.data.content.lectureTeacherList[0].name:"")+":"+s.assembleData.courseTitle,desc:a,link:s.shareLink||"",icon:s.assembleData.courseSurfacePlot,success:function(){},fail:function(){s.$toast("当前浏览器不支持分享！")}};s.nativeShare.setShareData(i);try{s.nativeShare.call(e)}catch(e){}}}))},share:function(){var e=this;if("micromessenger"==window.navigator.userAgent.toLowerCase().match(/MicroMessenger/i)||"undefined"!=typeof WeixinJSBridge)this.isWx=!0;else if(this.support)this.$toast.loading({mask:!1}),this.$http.post(this.$server.getCourseInfo,{courseId:this.assembleData.courseId}).then(function(s){if(200==s.data.status){var t=s.data.content.intro||"",a={title:(s.data.content.lectureTeacherList[0]?s.data.content.lectureTeacherList[0].name:"")+":"+e.assembleData.courseTitle,desc:t,link:e.shareLink,icon:e.assembleData.courseSurfacePlot,success:function(){},fail:function(){e.$toast("当前浏览器不支持分享！")}};e.nativeShare.setShareData(a);try{e.nativeShare.call("wechatFriend")}catch(e){}}});else{var s=this.clipboard;s.on("success",function(){e.$toast({message:"链接复制成功，可将该链接复制给好友，邀请他(她)来参团",className:"text-align"})}),s.on("error",function(){e.$toast("该浏览器不支持自动复制，请选择“拷贝”手动进行复制")})}},goPay:function(){var e=this;if(this.$getCookie("uInfo")){var s={courseId:this.assembleData.courseId};this.$http.post(this.$server.verifyUserAssemble,s).then(function(s){if(200==s.data.status)if(0==s.data.content.isJoin){localStorage.setItem("aboutCourse",e.$route.path);var t={buyType:2,assembleType:1,assembleId:e.$route.params.assembleId,assemblePrice:e.assembleData.assemblePrice};e.$router.push({path:"/course/order/"+e.assembleData.courseId,query:t})}else 1==s.data.content.isJoin&&e.$toast("您已参加过该团购");else s.data.message.includes("是会员")&&setTimeout(function(){e.$router.push("/course/"+e.assembleData.courseId)},2e3)})}else sessionStorage.setItem("rediectUrl",this.$route.fullPath),this.$router.push("/auth")},countDown:function(){var e=this,s=""!=this.serviceTime?new Date(this.serviceTime):new Date,t=new Date((new Date).setTime(s.getTime()+60*this.assembleContiTime*60*1e3));this.time=3600*this.assembleContiTime-1,this.timer=setInterval(function(){e.time--;var s=(new Date).getTime(),a=parseInt((t-s)/1e3);e.time-a>=1&&(console.log("从后台进入"),e.time=a),e.time<=0&&(e.countDownFlag=!1,clearInterval(e.timer))},1e3);var a=99;this.msTimer=setInterval(function(){a--,e.ms=a<10?"0"+a:a,e.time<=0&&(e.ms="00",e.countDownFlag=!1,clearInterval(e.msTimer)),a<=0&&(a=99)},10)},goCourse:function(){this.assembleBoughtData.courseId&&(sessionStorage.setItem("fromSuccess",!0),this.$router.replace("/course/"+this.assembleBoughtData.courseId)),this.assembleBoughtDataCourseId&&(sessionStorage.setItem("fromSuccess",!0),this.$router.replace("/course/"+this.assembleBoughtDataCourseId))},goCourses:function(){this.$router.push("/course/"+this.assembleData.courseId),this.assembleBoughtDataCourseId&&this.$router.replace("/course/"+this.assembleBoughtDataCourseId)},wxshare:function(e){var s=this,t=encodeURIComponent(window.location.href.split("#")[0]),a=this.$getCookie("uInfo"),i=a?JSON.parse(a).userid:"";this.$http.get(this.$server.getWxConfig+"?url="+t+"&userId="+i).then(function(t){if(200==t.data.status){var a=t.data.content;s.$http.post(s.$server.getCourseInfo,{courseId:e}).then(function(e){if(200==e.data.status){var t=e.data.content.title||"",i=e.data.content.surfacePlot||"",o=(e.data.content.lectureTeacherList[0]?e.data.content.lectureTeacherList[0].name:"")+":"+t,r=e.data.content.intro||"",n=s.shareLink,c=i;setShareInfo({title:o,summary:r,pic:c,url:n}),wx.config({debug:!1,appId:a.appId,timestamp:a.timeStamp,nonceStr:a.nonceStr,signature:a.signature,jsApiList:["checkJsApi","updateAppMessageShareData","updateTimelineShareData","onMenuShareAppMessage","onMenuShareTimeline","onMenuShareQQ"]}),wx.ready(function(){wx.onMenuShareAppMessage({title:o,desc:r,link:n,imgUrl:c,type:"",dataUrl:"",success:function(){}}),wx.onMenuShareTimeline({title:o,link:n,imgUrl:c,success:function(){}}),wx.onMenuShareQQ({title:o,desc:r,link:n,imgUrl:c,success:function(){},cancel:function(){}})})}})}})}}),destroyed:function(){clearInterval(this.timer),clearInterval(this.msTimer),this.setAssembleBoughtData({})}},g={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"assemble-open-wrap"},[t("Header",{attrs:{name:"开团"}}),e._v(" "),t("div",{staticClass:"content"},[t("div",{staticClass:"course-info clearfix",on:{click:e.goCourses}},[t("img",{staticClass:"course-surface",attrs:{src:e.assembleData.courseSurfacePlot}}),e._v(" "),t("div",{staticClass:"course-data"},[t("p",{staticClass:"course-name textEllipsis"},[e._v(e._s(e.assembleData.courseTitle))]),e._v(" "),t("p",{staticClass:"assemble-pirce"},[e._v("拼团价："+e._s("-"!=e.assembleData.assemblePrice?e.assembleData.assemblePrice.toFixed(2):"")+"币")]),e._v(" "),t("p",{staticClass:"original-price"},[e._v("原价："+e._s("-"!=e.assembleData.coursePrice?e.assembleData.coursePrice.toFixed(2):"")+"币")])])]),e._v(" "),t("div",{staticClass:"assemble-handle"},[1==e.assembleStatus?t("div",{staticClass:"no-assemble"},[t("p",[e._v("开团后"+e._s(e.assembleData.continueTime)+"小时结束")]),e._v(" "),t("p",{staticClass:"people"},[e._v(e._s(e.assembleData.peopleNum)+"人成团")]),e._v(" "),t("button",{on:{click:e.goPay}},[e._v("我要开团")])]):e._e(),e._v(" "),2==e.assembleStatus?t("div",{staticClass:"already-assemble"},[t("p",[e._v("开团成功")]),e._v(" "),t("p",{staticClass:"people"},[e._v(e._s(e.assembleData.peopleNum)+"人成团")]),e._v(" "),e.countDownFlag?t("p",{staticClass:"count-down"},[t("span",{staticClass:"need-people"},[e._v("还差"+e._s(e.assembleData.peopleNum>=1?e.assembleData.peopleNum-1:"-")+"人")]),e._v(" "),t("span",{staticClass:"hour"},[e._v(e._s(e.hour))]),e._v(" "),t("span",{staticClass:"minute"},[e._v(e._s(e.minute))]),e._v(" "),t("span",{staticClass:"second"},[e._v(e._s(e.second))]),e._v(" "),t("span",{staticClass:"msec"},[e._v(e._s(e.ms))]),e._v("\n                    后结束\n                ")]):e._e(),e._v(" "),t("button",{on:{click:function(s){e.shareOpen=!0}}},[e._v("邀请好友来参团")])]):e._e(),e._v(" "),3==e.assembleStatus?t("div",{staticClass:"assemble-success"},[t("p",[e._v("拼团成功")]),e._v(" "),t("p",{staticClass:"people"},[e._v(e._s(e.assembleData.peopleNum)+"人成团")]),e._v(" "),t("button",{on:{click:e.goCourse}},[e._v("查看课程")])]):e._e()]),e._v(" "),3==e.assembleStatus?t("div",{staticClass:"assemble-history"},[t("p",{staticClass:"t"},[e._v("拼团记录")]),e._v(" "),t("div",{staticClass:"list"},e._l(e.assemblePeopleList,function(s,a){return t("div",{key:a,staticClass:"item"},[t("div",{staticClass:"assemble-user-info clearfix"},[t("img",{attrs:{src:s.assembleHeadUrl}}),e._v(" "),t("p",{staticClass:"phone"},[e._v(e._s(s.assembleCellphone))])]),e._v(" "),t("p",{staticClass:"assemble-handle-status"},[e._v(e._s(1==s.assembleType?"发起拼团":"加入拼团"))]),e._v(" "),t("p",{staticClass:"assemble-time"},[e._v(e._s(s.assembleCreateTime))])])}),0)]):e._e(),e._v(" "),e._m(0)]),e._v(" "),e.isWx?t("div",{staticClass:"to-wechat-bgd",on:{click:function(s){e.isWx=!1}}},[t("i"),e._v(" "),t("p",[e._v("请点击右上角···发送给朋友")])]):e._e(),e._v(" "),t("transition",{attrs:{name:"fade"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.shareOpen,expression:"shareOpen"}],staticClass:"share-wrap"},[t("p",{staticClass:"tips"},[e._v("选择要分享的平台")]),e._v(" "),t("div",{staticClass:"share"},[e.support?t("div",{on:{click:function(s){return e.shareTo("wechatFriend")}}},[t("img",{attrs:{src:e.img1,alt:""}}),e._v(" "),t("p",[e._v("微信")])]):e._e(),e._v(" "),e.support?t("div",{on:{click:function(s){return e.shareTo("wechatTimeline")}}},[t("img",{attrs:{src:e.img2,alt:""}}),e._v(" "),t("p",[e._v("朋友圈")])]):e._e(),e._v(" "),t("div",{on:{click:function(s){return e.shareTo("qqFriend")}}},[t("img",{attrs:{src:e.img3,alt:""}}),e._v(" "),t("p",[e._v("QQ")])]),e._v(" "),t("div",{on:{click:function(s){return e.shareTo("weibo")}}},[t("img",{attrs:{src:e.img4,alt:""}}),e._v(" "),t("p",[e._v("微博")])])]),e._v(" "),t("div",{staticClass:"cancel",on:{click:function(s){e.shareOpen=!1}}},[e._v("\n                取消\n            ")])])])],1)},staticRenderFns:[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"rule"},[t("p",{staticClass:"t"},[e._v("拼团说明")]),e._v(" "),t("p",[e._v("1.用户点击学国学网拼团频道参于拼团，开团成为团长，并邀请好友参团，在拼团有效时间内凑齐成团人数，即可拼购成功。")]),e._v(" "),t("p",[e._v("2.在团有效时间内未凑齐成团人数，即拼团失败，系统自动取消订单并全额退款，支付金额将原路径退回。")]),e._v(" "),t("p",[e._v("3.拼团有效时间，即拼团允许邀请好友参团的时间，见拼团详情页。")]),e._v(" "),t("p",[e._v("4.用户在已购中，查看自己的拼团。")]),e._v(" "),t("p",[e._v("5.在拼团有效期内，已支付订单不允许申请退款。")]),e._v(" "),t("p",[e._v("6.拼团成功的课程将在拼团结束后加入到用户已购课程。")]),e._v(" "),t("p",[e._v("7.拼团如有其它问题，请咨询在线客服。")])])}]};var f=t("VU/8")(b,g,!1,function(e){t("692o")},"data-v-622078ef",null);s.default=f.exports}});
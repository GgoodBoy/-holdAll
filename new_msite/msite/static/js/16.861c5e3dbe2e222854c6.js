webpackJsonp([16],{F89D:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("Gu7T"),i=s.n(a),r=s("woOf"),n=s.n(r),o=s("Dd8w"),c=s.n(o),u=s("dQyo"),l=s.n(u),m=s("NYxO"),h=function(e,t){var s=parseInt(e/3600),a=parseInt(e%3600/60),i=parseInt(e%3600%60);return"h"==t?s<10?"0"+s:s:"m"==t?a<10?"0"+a:a:"s"==t?i<10?"0"+i:i:void 0};var d={data:function(){return{nativeShare:"",support:!1,clipboard:"",shareLink:"",shareOpen:!1,time:0,ms:"00",msTimer:"",timer:"",nickname:"-",avatar:"",fail:!1,finish:!1,isWx:!1,wxBgd:!1}},props:["courseAssembleData","assembleData"],watch:{courseAssembleData:function(e,t){var s=this;if(this.finish=!0,e.hasOwnProperty("endTimeStr")){this.fail=!1,this.countDown();var a=window.navigator.userAgent.toLowerCase();"micromessenger"==a.match(/MicroMessenger/i)||"undefined"!=typeof WeixinJSBridge?this.wxshare():"qq"==a.match(/QQ/i)&&"mqqbrowser"!=a.match(/MQQbrowser/i)&&this.wxshare(),this.$nextTick(function(){s.clipboard=new l.a(s.$refs.copyBtn)})}else this.fail=!0}},created:function(){this.nativeShare=new NativeShare,this.browserSupport();var e=this.$getCookie("uInfo");e&&JSON.parse(e).userid;this.shareLink=window.location.origin+"/"+window.location.search,this.$route.query&&this.$route.query.assembleUser&&this.getShareUserInfo()},mounted:function(){var e=window.navigator.userAgent.toLowerCase();"micromessenger"==e.match(/MicroMessenger/i)||"undefined"!=typeof WeixinJSBridge?this.isWx=!0:"qq"==e.match(/QQ/i)&&"mqqbrowser"!=e.match(/MQQbrowser/i)&&(this.isWx=!0)},computed:c()({},Object(m.c)(["isVip"]),{hour:function(){return h(this.time,"h")},minute:function(){return h(this.time,"m")},second:function(){return h(this.time,"s")}}),methods:{countDown:function(){var e=this,t=new Date(this.courseAssembleData.endTimeStr.replace(/-/g,"/")).getTime(),s=(new Date).getTime(),a=parseInt((t-s)/1e3);this.time=a,this.timer=setInterval(function(){e.time--;var s=(new Date).getTime(),a=parseInt((t-s)/1e3);e.time-a>=1&&(e.time=a),e.time<=0&&clearInterval(e.timer)},1e3);var i=99;this.msTimer=setInterval(function(){i--,e.ms=i<10?"0"+i:i,e.time<=0&&(e.ms="00",clearInterval(e.msTimer)),i<=0&&(i=99)},10)},getShareUserInfo:function(){var e=this,t={userId:this.$route.query.assembleUser};this.$http.post(this.$server.getShareUserInfo,t).then(function(t){200==t.data.status&&(e.nickname=t.data.content.nickname,e.avatar=t.data.content.avatar)})},goJoin:function(){var e=this;if(this.$getCookie("uInfo")){if(this.isVip)return this.$toast("您是会员，可以免费观看该课"),setTimeout(function(){e.$router.replace("/course/"+e.courseAssembleData.courseId)},2e3),!1;var t={courseId:this.courseAssembleData.courseId};this.$http.post(this.$server.verifyUserAssemble,t).then(function(t){if(200==t.data.status)if(0==t.data.content.isJoin){localStorage.setItem("aboutCourse",e.$route.path);var s={buyType:2,assembleType:2,assembleId:e.$route.params.assembleId,assemblePrice:e.courseAssembleData.assemblePrice,joinAssembleRecordId:e.$route.query.assembleRecordId};e.$router.push({path:"/course/order/"+e.courseAssembleData.courseId,query:s})}else 1==t.data.content.isJoin&&(e.$toast("您已参加过该团购"),setTimeout(function(){e.$router.push("/bought")},2e3));else t.data.message.includes("已购买该课程")&&setTimeout(function(){e.$router.push("/bought")},2e3)})}else sessionStorage.setItem("rediectUrl",this.$route.fullPath),this.$router.push("/auth")},browserSupport:function(){var e=navigator.appVersion,t=e.split("UCBrowser/").length>1?1:0,s=e.split("MQQBrowser/").length>1?2:0;this.support=!(!t&&!s)},invite:function(){this.isWx?this.wxBgd=!0:this.shareOpen=!0},shareTo:function(e){var t=this;this.$toast.loading({mask:!1}),this.$http.post(this.$server.getCourseInfo,{courseId:this.assembleData.courseId}).then(function(s){if(200==s.data.status){var a=s.data.content.intro||"",i={title:(s.data.content.lectureTeacherList[0]?s.data.content.lectureTeacherList[0].name:"")+":"+t.assembleData.courseTitle,desc:a,link:t.shareLink||"",icon:t.assembleData.courseSurfacePlot,success:function(){},fail:function(){t.$toast("当前浏览器不支持分享！")}};t.nativeShare.setShareData(i);try{t.nativeShare.call(e)}catch(e){}}})},share:function(){var e=this;if("micromessenger"==window.navigator.userAgent.toLowerCase().match(/MicroMessenger/i)||"undefined"!=typeof WeixinJSBridge)this.isWx=!0;else if(this.support)this.$toast.loading({mask:!1}),this.$http.post(this.$server.getCourseInfo,{courseId:this.courseAssembleData.courseId}).then(function(t){if(200==t.data.status){var s=t.data.content.intro||"",a={title:(t.data.content.lectureTeacherList[0]?t.data.content.lectureTeacherList[0].name:"")+":"+e.assembleData.courseTitle,desc:s,link:e.shareLink,icon:e.assembleData.courseSurfacePlot,success:function(){},fail:function(){e.$toast("当前浏览器不支持分享！")}};e.nativeShare.setShareData(a);try{e.nativeShare.call("wechatFriend")}catch(e){}}});else{var t=this.clipboard;t.on("success",function(){e.$toast({message:"链接复制成功，可将该链接复制给好友，邀请他(她)来参团",className:"text-align"})}),t.on("error",function(){e.$toast("该浏览器不支持自动复制，请选择“拷贝”手动进行复制")})}},wxshare:function(){var e=this,t=encodeURIComponent(window.location.href.split("#")[0]),s=this.$getCookie("uInfo"),a=s?JSON.parse(s).userid:"";this.$http.get(this.$server.getWxConfig+"?url="+t+"&userId="+a).then(function(t){if(200==t.data.status){var s=t.data.content;e.$http.post(e.$server.getCourseInfo,{courseId:e.courseAssembleData.courseId}).then(function(t){if(200==t.data.status){var a=t.data.content.title||"",i=t.data.content.surfacePlot||"",r=(t.data.content.lectureTeacherList[0]?t.data.content.lectureTeacherList[0].name:"")+":"+a,n=t.data.content.intro||"",o=e.shareLink,c=i;setShareInfo({title:r,summary:n,pic:c,url:o}),wx.config({debug:!1,appId:s.appId,timestamp:s.timeStamp,nonceStr:s.nonceStr,signature:s.signature,jsApiList:["checkJsApi","updateAppMessageShareData","updateTimelineShareData","onMenuShareAppMessage","onMenuShareTimeline","onMenuShareQQ"]}),wx.ready(function(){wx.onMenuShareAppMessage({title:r,desc:n,link:o,imgUrl:c,type:"",dataUrl:"",success:function(){}}),wx.onMenuShareTimeline({title:r,link:o,imgUrl:c,success:function(){}}),wx.onMenuShareQQ({title:r,desc:n,link:o,imgUrl:c,success:function(){},cancel:function(){}})})}})}})}},destroyed:function(){clearInterval(this.timer),clearInterval(this.msTimer)}},p={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"join-course-assemble"},[e.finish?s("div",[e.fail?s("div",{staticClass:"box fail"},[s("p",{staticClass:"t"},[e._v("参团失败")]),e._v(" "),s("p",{staticClass:"tips"},[e._v("该团已拼团成功，请选择其他拼团")]),e._v(" "),s("button",{staticClass:"tips-btn",on:{click:function(t){return e.$router.replace("/assemble/list")}}},[e._v("确认")])]):s("div",{staticClass:"box"},[s("p",{staticClass:"assemble-open-user"},[e._v("参与"+e._s(e.courseAssembleData.createorPhone)+"的团")]),e._v(" "),s("p",{staticClass:"assemble-name"},[e._v("你的好友"),s("span",[e._v(e._s(e.nickname))])]),e._v(" "),s("div",{staticClass:"assemble-users-head"},[s("img",{attrs:{src:e.avatar}})]),e._v(" "),s("p",{staticClass:"count-down"},[s("span",{staticClass:"need-people"},[e._v("还差"+e._s(e.courseAssembleData.remainderNum)+"人")]),e._v(" "),s("span",{staticClass:"hour"},[e._v(e._s(e.hour))]),e._v(" "),s("span",{staticClass:"minute"},[e._v(e._s(e.minute))]),e._v(" "),s("span",{staticClass:"second"},[e._v(e._s(e.second))]),e._v(" "),s("span",{staticClass:"msec"},[e._v(e._s(e.ms))]),e._v("\n                后结束\n            ")]),e._v(" "),s("input",{staticClass:"copy-target",attrs:{id:"input",readonly:""},domProps:{value:e.shareLink}}),e._v(" "),s("button",{staticClass:"join-btn",on:{click:e.goJoin}},[e._v("我要参团")]),e._v(" "),s("button",{staticClass:"share-course-btn",on:{click:e.invite}},[e._v("邀请好友来参团")]),e._v(" "),s("p",{staticClass:"tip"},[e._v("提示：锁定参团后请在10分钟内完成支付")]),e._v(" "),s("p",{staticClass:"tip"},[e._v("逾期订单将失效")])])]):s("div",{staticClass:"loading"},[s("van-loading",{attrs:{size:"1rem"}})],1),e._v(" "),e.wxBgd?s("div",{staticClass:"to-wechat-bgd",on:{click:function(t){e.wxBgd=!1}}},[s("i"),e._v(" "),s("p",[e._v("请点击右上角···发送给朋友")])]):e._e(),e._v(" "),s("transition",{attrs:{name:"fade"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.shareOpen,expression:"shareOpen"}],staticClass:"share-wrap"},[s("p",{staticClass:"tips"},[e._v("选择要分享的平台")]),e._v(" "),s("div",{staticClass:"share"},[e.support?s("div",{on:{click:function(t){return e.shareTo("wechatFriend")}}},[s("img",{attrs:{src:"./static/img/course/wechat.png",alt:""}}),e._v(" "),s("p",[e._v("微信")])]):e._e(),e._v(" "),e.support?s("div",{on:{click:function(t){return e.shareTo("wechatTimeline")}}},[s("img",{attrs:{src:"./static/img/course/wechat-circle.png",alt:""}}),e._v(" "),s("p",[e._v("朋友圈")])]):e._e(),e._v(" "),s("div",{on:{click:function(t){return e.shareTo("qqFriend")}}},[s("img",{attrs:{src:"./static/img/course/qq.png",alt:""}}),e._v(" "),s("p",[e._v("QQ")])]),e._v(" "),s("div",{on:{click:function(t){return e.shareTo("weibo")}}},[s("img",{attrs:{src:"./static/img/course/weibo.png",alt:""}}),e._v(" "),s("p",[e._v("微博")])])]),e._v(" "),s("div",{staticClass:"cancel",on:{click:function(t){e.shareOpen=!1}}},[e._v("\n                取消\n            ")])])])],1)},staticRenderFns:[]};var v=function(e){var t=parseInt(e/3600),s=parseInt(e%3600/60),a=parseInt(e%3600%60);return(t<10?"0"+t:t)+":"+(s<10?"0"+s:s)+":"+(a<10?"0"+a:a)},f={data:function(){return{assembleCourseId:"",list:[],currentPage:1,pageSize:10,loading:!1,finished:!1,assembleData:{continueTime:"-",courseTitle:"-",assemblePrice:"-",courseSurfacePlot:"",coursePrice:"-",courseId:"-",peopleNum:"-"},courseAssembleFlag:!1,courseAssembleData:{}}},components:{CourseAssemble:s("VU/8")(d,p,!1,function(e){s("gQKH")},"data-v-cf9e987c",null).exports,Header:s("teIl").a},inject:["reload"],computed:c()({},Object(m.c)(["hasOpenApp","audioData"])),beforeRouteLeave:function(e,t,s){"CourseOrder"==e.name&&0!=this.assembleData.channelAvaliDay?this.$dialog.confirm({message:"为了您更好的学习该课程内容，课程购买后，学习有效期至"+this.assembleData.channelAvaliDay+",请于有效期内学习完该课程",confirmButtonColor:"#D40015"}).then(function(){s()}).catch(function(){}):s()},created:function(){this.$route.query&&this.$route.query.assembleRecordId&&(this.courseAssembleFlag=!0);var e=n()({},this.audioData,{bottom:"1rem"});this.setAudioData(e)},methods:c()({},Object(m.b)(["setAudioData"]),{returnHome:function(){this.$router.push("/")},onClickLeft:function(){this.$router.go(-1)},getJoinAssembleCourseInfo:function(){var e=this;if(this.$route.params&&this.$route.params.assembleId){this.assembleCourseId=this.$route.params.assembleId;var t={currentPage:this.currentPage,pageSize:this.pageSize,assembleCourseId:this.$route.params.assembleId};this.$http.post(this.$server.getJoinAssembleCourseInfo,t).then(function(t){if(200==t.data.status){if(e.assembleData.hasOwnProperty("id")||(e.assembleData={id:t.data.content.id,assemblePrice:t.data.content.assemblePrice,courseId:t.data.content.courseId,coursePrice:t.data.content.coursePrice,courseSurfacePlot:t.data.content.courseSurfacePlot,courseTitle:t.data.content.courseTitle,channelAvaliDay:t.data.content.channelAvaliDay}),e.list=[].concat(i()(e.list),i()(t.data.content.pageInfo.list)),e.currentPage++,e.loading=!1,e.finished=!!t.data.content.pageInfo.isLastPage,e.$route.query.assembleRecordId){var s=e.list.find(function(t){return t.id==e.$route.query.assembleRecordId});e.courseAssembleData=s||{},e.courseAssembleData.assemblePrice=t.data.content.assemblePrice,e.courseAssembleData.courseId=t.data.content.courseId}e.countDown()}})}},countDown:function(){var e=this,t=(new Date).getTime();this.list.forEach(function(s,a){var r=new Date(s.endTimeStr.replace(/-/g,"/")).getTime(),n=parseInt((r-t)/1e3);n>0?(s.show=!0,s.time=n,s.timeStr=v(n),s.timer=null,s.timer=setInterval(function(){var t=[].concat(i()(e.list));t[a].time--;var s=t[a].time;t[a].timeStr=v(s);var n=(new Date).getTime(),o=parseInt((r-n)/1e3);s-o>=1&&(s=o,t[a].timeStr=v(s)),s<=0&&e.list.forEach(function(e){clearInterval(e.timer)}),e.list=t},1e3)):s.show=!1})},goOpen:function(){var e=this;if(this.$getCookie("uInfo")){var t={courseId:this.assembleData.courseId};this.$http.post(this.$server.verifyUserAssemble,t).then(function(t){if(200==t.data.status)if(0==t.data.content.isJoin){localStorage.setItem("aboutCourse",e.$route.path);var s={buyType:2,assembleType:1,assembleId:e.$route.params.assembleId,assemblePrice:e.assembleData.assemblePrice};e.$router.push({path:"/course/order/"+e.assembleData.courseId,query:s})}else 1==t.data.content.isJoin&&e.$toast("您已参加过该团购");else t.data.message.includes("是会员")&&setTimeout(function(){e.$router.push("/course/"+e.assembleData.courseId)},2e3)})}else sessionStorage.setItem("rediectUrl",this.$route.fullPath),this.$router.push("/auth")},goJoin:function(e){var t=this;if(this.$getCookie("uInfo")){var s={courseId:this.assembleData.courseId};this.$http.post(this.$server.verifyUserAssemble,s).then(function(s){if(200==s.data.status)if(0==s.data.content.isJoin){localStorage.setItem("aboutCourse",t.$route.path);var a={buyType:2,assembleType:2,assembleId:t.$route.params.assembleId,assemblePrice:t.assembleData.assemblePrice,joinAssembleRecordId:e.id};t.$router.push({path:"/course/order/"+t.assembleData.courseId,query:a})}else 1==s.data.content.isJoin&&t.$toast("您已参加过该团购");else s.data.message.includes("是会员")&&setTimeout(function(){t.$router.push("/course/"+t.assembleData.courseId)},2e3)})}else sessionStorage.setItem("rediectUrl",this.$route.fullPath),this.$router.push("/auth")},goCourse:function(){this.$router.push("/course/"+this.assembleData.courseId)}}),beforeDestroy:function(){this.list.forEach(function(e){clearInterval(e.timer)})}},b={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"join-assemble"},[s("Header",{attrs:{name:"参团"}}),e._v(" "),s("div",{staticClass:"content"},[s("div",{staticClass:"course-info clearfix",on:{click:e.goCourse}},[s("img",{staticClass:"course-surface",attrs:{src:e.assembleData.courseSurfacePlot}}),e._v(" "),s("div",{staticClass:"course-data"},[s("p",{staticClass:"course-name textEllipsis"},[e._v(e._s(e.assembleData.courseTitle))]),e._v(" "),s("p",{staticClass:"assemble-pirce"},[e._v("拼团价："+e._s("-"!=e.assembleData.assemblePrice?e.assembleData.assemblePrice.toFixed(2):"")+"币")]),e._v(" "),s("p",{staticClass:"original-price"},[e._v("原价："+e._s("-"!=e.assembleData.coursePrice?e.assembleData.coursePrice.toFixed(2):"")+"币")])])]),e._v(" "),s("div",{staticClass:"list-wrap"},[s("div",{staticClass:"list"},[s("van-list",{attrs:{finished:e.finished},on:{load:e.getJoinAssembleCourseInfo},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.list,function(t,a){return s("div",{key:a,staticClass:"item"},[t.show?s("div",{staticClass:"block"},[s("p",{staticClass:"phone"},[e._v(e._s(t.createorPhone))]),e._v(" "),s("div",{staticClass:"status"},[s("p",{staticClass:"need"},[e._v("还差"+e._s(t.remainderNum)+"人成团")]),e._v(" "),s("p",{staticClass:"count-down"},[e._v("距离结束还有"),s("span",[e._v(e._s(t.timeStr))])])]),e._v(" "),s("button",{on:{click:function(s){return e.goJoin(t)}}},[e._v("立即参团")])]):e._e()])}),0)],1)])]),e._v(" "),s("button",{staticClass:"open-assemble-btn",on:{click:e.goOpen}},[e._v("我要开团（"+e._s("-"!=e.assembleData.assemblePrice?e.assembleData.assemblePrice.toFixed(2):"")+"币）")]),e._v(" "),e.courseAssembleFlag?s("CourseAssemble",{attrs:{courseAssembleData:e.courseAssembleData,assembleData:e.assembleData}}):e._e()],1)},staticRenderFns:[]};var g=s("VU/8")(f,b,!1,function(e){s("ihCZ")},"data-v-62491246",null);t.default=g.exports},gQKH:function(e,t){},ihCZ:function(e,t){}});
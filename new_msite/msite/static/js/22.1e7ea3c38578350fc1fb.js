webpackJsonp([22],{"2yBr":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("mvHQ"),n=i.n(s),o=i("Gu7T"),r=i.n(o),a={data:function(){return{historyList:[],loading:!0,hotList:[],keywords:""}},created:function(){this.getHotWords(),this.getHistory()},methods:{search:function(){var t=this.keywords;if(""==t)return!1;var e=[].concat(r()(this.historyList)),i={name:t};if(e.length>0){var s=e.findIndex(function(e){return e.name==t});s>=0&&e.splice(s,1),e.unshift(i)}else e.push(i);window.localStorage.setItem("history",n()(e)),this.$router.push("/search/result/"+t)},getHistory:function(){var t=window.localStorage.getItem("history")?JSON.parse(window.localStorage.getItem("history")):[];this.historyList=t},emptySingle:function(t){var e=[].concat(r()(this.historyList)),i=e.findIndex(function(e){return e.id==t.id});e.splice(i,1),window.localStorage.setItem("history",n()(e)),this.historyList=e},empty:function(){var t=this;this.$dialog.confirm({confirmButtonColor:"#D40015",message:"确定清空所有历史数据吗"}).then(function(){t.historyList=[],window.localStorage.setItem("history",n()(t.historyList))}).catch(function(){})},goViews:function(t){var e=[].concat(r()(this.historyList));if(e.length>0){var i=e.findIndex(function(e){return e.id==t.id});i>=0&&e.splice(i,1),e.unshift(t)}else e.push(t);window.localStorage.setItem("history",n()(e)),this.$router.push("/search/result/"+t.name)},getHotWords:function(){var t=this;this.$http.post(this.$server.getHotWordList,{}).then(function(e){200==e.data.status&&(t.hotList=e.data.content,t.loading=!1)})},goDetail:function(t){var e=[].concat(r()(this.historyList));if(e.length>0){var i=e.findIndex(function(e){return e.id==t.id});i>=0&&e.splice(i,1),e.unshift(t)}else e.push(t);window.localStorage.setItem("history",n()(e)),this.$router.push("/search/result/"+t.name)}}},c={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("header",[i("div",{staticClass:"search"},[i("form",{attrs:{action:"javascript:return true"}},[i("van-icon",{attrs:{name:"search"}}),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.keywords,expression:"keywords"}],attrs:{type:"search",autofocus:"",placeholder:"请输入要搜索的内容",maxlength:"6"},domProps:{value:t.keywords},on:{keydown:function(e){return e.type.indexOf("key")||13===e.keyCode?t.search(e):null},input:function(e){e.target.composing||(t.keywords=e.target.value)}}})],1)]),t._v(" "),i("div",{staticClass:"cancel c3a",on:{click:function(e){return t.$router.go(-1)}}},[t._v("取消")])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.historyList.length>0,expression:"historyList.length>0"}],staticClass:"history-record"},[i("div",{staticClass:"clearfix"},[i("div",{staticClass:"title"},[t._v("搜索历史")]),t._v(" "),i("van-icon",{staticClass:"empty-btn",attrs:{name:"delete"},on:{click:t.empty}})],1),t._v(" "),i("div",{staticClass:"history-list clearfix"},t._l(t.historyList.slice(0,10),function(e,s){return i("div",{key:s,staticClass:"history-item",on:{click:function(i){return t.goViews(e)}}},[i("p",[t._v(t._s(e.name))])])}),0)]),t._v(" "),i("div",{staticClass:"hot-search-title"},[i("div",{staticClass:"title"},[t._v("大家都在搜")]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"loading-wrap"},[i("van-loading",{attrs:{type:"spinner"}})],1),t._v(" "),i("ul",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],staticClass:"clearfix"},t._l(t.hotList,function(e,s){return i("li",{key:s,staticClass:"c9a",on:{click:function(i){return t.goDetail(e)}}},[t._v(t._s(e.name))])}),0)])])},staticRenderFns:[]};var l=i("VU/8")(a,c,!1,function(t){i("8P11")},"data-v-e7f86710",null);e.default=l.exports},"8P11":function(t,e){}});